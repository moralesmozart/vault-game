<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Legends of the Vault ‚Äì Vault of Causes</title>
    <!-- Deployed via GitHub Pages -->
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: #e0e0e0;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
        }

        /* Animated background particles */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 50%, rgba(212, 175, 55, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(212, 175, 55, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        /* Tab Navigation */
        .tab-navigation {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            border-bottom: 2px solid rgba(212, 175, 55, 0.3);
            padding-bottom: 0;
        }

        .tab-button {
            background: rgba(15, 52, 96, 0.6);
            border: 2px solid rgba(212, 175, 55, 0.2);
            border-bottom: none;
            color: #aaa;
            padding: 15px 30px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: 10px 10px 0 0;
            transition: all 0.3s ease;
            position: relative;
            top: 2px;
        }

        .tab-button:hover {
            background: rgba(15, 52, 96, 0.8);
            color: #d4af37;
        }

        .tab-button.active {
            background: rgba(26, 26, 46, 0.9);
            border-color: #d4af37;
            color: #d4af37;
            border-bottom: 2px solid rgba(26, 26, 46, 0.9);
            top: 0;
            box-shadow: 0 -5px 15px rgba(212, 175, 55, 0.2);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* Header */
        header {
            text-align: center;
            padding: 30px 20px;
            margin-bottom: 40px;
        }

        h1 {
            font-size: 3.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #d4af37 0%, #ffd700 50%, #d4af37 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-shadow: 0 0 30px rgba(212, 175, 55, 0.5);
            margin-bottom: 10px;
            letter-spacing: 2px;
        }

        .subtitle {
            font-size: 1.3rem;
            color: #d4af37;
            margin-bottom: 15px;
            font-style: italic;
        }

        .disclaimer {
            font-size: 0.85rem;
            color: #888;
            font-style: italic;
        }

        /* Intro Section */
        .intro-section {
            background: rgba(26, 26, 46, 0.9);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 40px;
            backdrop-filter: blur(10px);
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
        }

        .intro-section h2 {
            color: #d4af37;
            font-size: 2rem;
            margin-bottom: 20px;
            text-align: center;
            border-bottom: 2px solid rgba(212, 175, 55, 0.3);
            padding-bottom: 15px;
        }

        .intro-content {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
        }

        @media (min-width: 768px) {
            .intro-content {
                grid-template-columns: 1fr 1fr;
            }
        }

        .intro-block {
            background: rgba(15, 52, 96, 0.4);
            border-left: 4px solid #d4af37;
            border-radius: 10px;
            padding: 20px;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .intro-block:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.2);
        }

        .intro-block h3 {
            color: #ffd700;
            font-size: 1.3rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .intro-block h3::before {
            content: '‚ñ∏';
            color: #d4af37;
            font-size: 1.5rem;
        }

        .intro-block p {
            line-height: 1.7;
            color: #e0e0e0;
            font-size: 1rem;
        }

        .intro-block ul {
            list-style: none;
            padding-left: 0;
            margin-top: 10px;
        }

        .intro-block li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
            line-height: 1.6;
            color: #e0e0e0;
        }

        .intro-block li::before {
            content: '‚úì';
            position: absolute;
            left: 0;
            color: #d4af37;
            font-weight: bold;
        }

        .differentiators {
            grid-column: 1 / -1;
            margin-top: 10px;
        }

        .differentiators-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
            margin-top: 20px;
        }

        @media (min-width: 768px) {
            .differentiators-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .differentiator-item {
            background: rgba(15, 52, 96, 0.5);
            border: 2px solid rgba(212, 175, 55, 0.2);
            border-radius: 12px;
            padding: 20px;
            transition: all 0.3s ease;
        }

        .differentiator-item:hover {
            border-color: rgba(212, 175, 55, 0.5);
            box-shadow: 0 5px 25px rgba(212, 175, 55, 0.2);
            transform: translateY(-3px);
        }

        .differentiator-number {
            display: inline-block;
            background: linear-gradient(135deg, #d4af37 0%, #ffd700 100%);
            color: #1a1a2e;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            text-align: center;
            line-height: 35px;
            font-weight: 700;
            font-size: 1.1rem;
            margin-right: 12px;
            margin-bottom: 10px;
        }

        .differentiator-item h4 {
            color: #ffd700;
            font-size: 1.2rem;
            margin-bottom: 10px;
            display: inline-block;
        }

        .differentiator-item p {
            color: #e0e0e0;
            line-height: 1.7;
            margin-top: 8px;
        }

        /* Main Game Area */
        .game-section {
            display: grid;
            grid-template-columns: 1fr;
            gap: 30px;
            margin-bottom: 40px;
        }

        @media (min-width: 768px) {
            .game-section {
                grid-template-columns: 2fr 1fr;
            }
        }

        /* Cause Selection */
        .cause-panel {
            background: rgba(26, 26, 46, 0.8);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }

        .cause-panel h2 {
            color: #d4af37;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .causes {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .cause-option {
            background: rgba(15, 52, 96, 0.6);
            border: 2px solid rgba(212, 175, 55, 0.2);
            border-radius: 10px;
            padding: 15px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            gap: 12px;
            position: relative;
        }

        .cause-option:hover {
            border-color: rgba(212, 175, 55, 0.6);
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(212, 175, 55, 0.2);
        }

        .cause-option.selected {
            border-color: #d4af37;
            background: rgba(212, 175, 55, 0.15);
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.4);
        }

        .cause-header {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .cause-emoji {
            font-size: 2rem;
            flex-shrink: 0;
        }

        .cause-name {
            font-size: 1.1rem;
            font-weight: 600;
            flex: 1;
        }

        .cause-info-icon {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 0.9rem;
            color: #d4af37;
            opacity: 0.6;
            transition: opacity 0.3s ease;
        }

        .cause-option:hover .cause-info-icon {
            opacity: 1;
        }

        .cause-kpis {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 10px;
            margin-top: 8px;
            padding-top: 12px;
            border-top: 1px solid rgba(212, 175, 55, 0.2);
        }

        .cause-kpi-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            padding: 10px 8px;
            background: rgba(26, 26, 46, 0.5);
            border-radius: 8px;
            border: 1px solid rgba(212, 175, 55, 0.15);
            transition: all 0.3s ease;
        }

        .cause-option:hover .cause-kpi-item {
            background: rgba(26, 26, 46, 0.7);
            border-color: rgba(212, 175, 55, 0.3);
            transform: translateY(-2px);
        }

        .cause-kpi-label {
            font-size: 0.7rem;
            color: #aaa;
            margin-bottom: 6px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            font-weight: 600;
        }

        .cause-kpi-value {
            font-size: 0.95rem;
            font-weight: 700;
            color: #ffd700;
            line-height: 1.2;
        }

        .cause-kpi-value.multiplier {
            color: #4ade80;
            font-size: 1.1rem;
            text-shadow: 0 0 10px rgba(74, 222, 128, 0.3);
        }

        .cause-kpi-value.multiplier {
            color: #ffd700;
            font-size: 1.1rem;
        }

        /* Slot Machine */
        .slot-machine {
            background: rgba(26, 26, 46, 0.8);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .reels-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin: 30px 0;
            perspective: 1000px;
            flex-wrap: wrap;
        }

        .reel {
            width: 90px;
            height: 110px;
            background: rgba(15, 52, 96, 0.8);
            border: 3px solid #d4af37;
            border-radius: 10px;
            position: relative;
            overflow: hidden;
            box-shadow: inset 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .reel-strip {
            position: absolute;
            width: 100%;
            top: 0;
            left: 0;
            transition: transform 0.1s linear;
        }

        .reel.spinning .reel-strip {
            transition: none;
            filter: blur(2px);
            animation: spinGlow 0.3s ease-in-out infinite alternate;
        }

        @keyframes spinGlow {
            0% {
                filter: blur(2px) brightness(1);
            }
            100% {
                filter: blur(3px) brightness(1.2);
            }
        }

        .reel-symbol {
            width: 100%;
            height: 110px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3.5rem;
            flex-shrink: 0;
        }

        .reel::before,
        .reel::after {
            content: '';
            position: absolute;
            left: 0;
            right: 0;
            height: 20px;
            z-index: 10;
            pointer-events: none;
        }

        .reel::before {
            top: 0;
            background: linear-gradient(to bottom, rgba(26, 26, 46, 0.9), transparent);
        }

        .reel::after {
            bottom: 0;
            background: linear-gradient(to top, rgba(26, 26, 46, 0.9), transparent);
        }

        .bet-section {
            margin: 25px 0;
            text-align: center;
        }

        .bet-label {
            color: #d4af37;
            font-size: 1.1rem;
            font-weight: 600;
            margin-bottom: 12px;
            display: block;
        }

        .bet-input-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .bet-currency {
            color: #d4af37;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .bet-input {
            background: rgba(15, 52, 96, 0.8);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 10px;
            color: #e0e0e0;
            font-size: 1.5rem;
            font-weight: 700;
            padding: 15px 20px;
            width: 200px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .bet-input:focus {
            outline: none;
            border-color: #d4af37;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
            background: rgba(15, 52, 96, 1);
        }

        .bet-input::placeholder {
            color: #666;
        }

        .bet-info {
            color: #aaa;
            font-size: 0.9rem;
            margin-top: 8px;
            font-style: italic;
        }

        .bet-impact {
            color: #4ade80;
            font-size: 1rem;
            font-weight: 600;
            margin-top: 10px;
        }

        /* Bet Input Section */
        .bet-section {
            margin: 25px 0;
            padding: 20px;
            background: rgba(15, 52, 96, 0.4);
            border-radius: 12px;
            border: 2px solid rgba(212, 175, 55, 0.2);
        }

        .bet-label {
            color: #d4af37;
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 12px;
            display: block;
        }

        .bet-input-container {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            margin-bottom: 15px;
        }

        .bet-currency {
            color: #d4af37;
            font-size: 1.5rem;
            font-weight: 700;
        }

        .bet-input {
            background: rgba(26, 26, 46, 0.8);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 8px;
            color: #e0e0e0;
            font-size: 1.5rem;
            font-weight: 700;
            padding: 12px 20px;
            width: 180px;
            text-align: center;
            transition: all 0.3s ease;
        }

        .bet-input:focus {
            outline: none;
            border-color: #d4af37;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
        }

        .bet-input::placeholder {
            color: #666;
        }

        .bet-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 12px;
            padding-top: 12px;
            border-top: 1px solid rgba(212, 175, 55, 0.2);
        }

        .bet-amount-display {
            color: #aaa;
            font-size: 0.9rem;
        }

        .bet-percentage {
            color: #ffd700;
            font-size: 1.1rem;
            font-weight: 700;
        }

        .bet-percentage-label {
            color: #aaa;
            font-size: 0.85rem;
            margin-left: 5px;
        }

        .bet-max-button {
            background: rgba(212, 175, 55, 0.2);
            border: 1px solid rgba(212, 175, 55, 0.4);
            color: #d4af37;
            padding: 6px 12px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.3s ease;
            margin-left: 10px;
        }

        .bet-max-button:hover {
            background: rgba(212, 175, 55, 0.3);
            transform: scale(1.05);
        }

        .spin-button {
            background: linear-gradient(135deg, #d4af37 0%, #ffd700 100%);
            border: none;
            color: #1a1a2e;
            font-size: 1.5rem;
            font-weight: 700;
            padding: 20px 60px;
            border-radius: 50px;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 2px;
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.4);
            margin-top: 20px;
        }

        .spin-button:hover:not(:disabled) {
            transform: scale(1.05);
            box-shadow: 0 8px 30px rgba(212, 175, 55, 0.6);
        }

        .spin-button:active:not(:disabled) {
            transform: scale(0.98);
        }

        .spin-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
        }

        .result-message {
            margin-top: 25px;
            font-size: 1.3rem;
            font-weight: 600;
            min-height: 40px;
            transition: all 0.3s ease;
        }

        .result-message.win {
            color: #4ade80;
            animation: pulse 0.5s ease;
        }

        .result-message.loss {
            color: #fbbf24;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        /* Game Rules Section */
        .game-rules {
            margin-top: 30px;
            padding: 20px;
            background: rgba(15, 52, 96, 0.4);
            border-radius: 12px;
            border: 2px solid rgba(212, 175, 55, 0.2);
        }

        .game-rules h3 {
            color: #d4af37;
            font-size: 1.1rem;
            margin-bottom: 15px;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .rules-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .rules-list li {
            padding: 10px 0;
            padding-left: 30px;
            position: relative;
            color: #e0e0e0;
            line-height: 1.6;
            font-size: 0.95rem;
        }

        .rules-list li::before {
            content: '‚ñ∏';
            position: absolute;
            left: 0;
            color: #d4af37;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .rules-list li.highlight {
            color: #4ade80;
            font-weight: 600;
            margin-top: 8px;
            padding-top: 12px;
            border-top: 1px solid rgba(74, 222, 128, 0.3);
        }

        .rules-list li.highlight::before {
            content: '‚≠ê';
            color: #4ade80;
        }

        /* Impact Progression */
        .progress-panel {
            background: rgba(26, 26, 46, 0.8);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
            margin-bottom: 30px;
        }

        .progress-panel h2 {
            color: #d4af37;
            margin-bottom: 15px;
            font-size: 1.5rem;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 10px;
            font-size: 0.9rem;
            color: #aaa;
        }

        .progress-bar-container {
            background: rgba(15, 52, 96, 0.6);
            border-radius: 10px;
            height: 30px;
            overflow: hidden;
            position: relative;
            border: 2px solid rgba(212, 175, 55, 0.2);
        }

        .progress-bar {
            background: linear-gradient(90deg, #d4af37 0%, #ffd700 100%);
            height: 100%;
            width: 0%;
            transition: width 0.8s ease;
            position: relative;
            box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
        }

        .progress-bar::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }

        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        .progress-percentage {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-weight: 700;
            color: #1a1a2e;
            z-index: 1;
        }

        /* Stats Panel */
        .stats-panel {
            background: rgba(26, 26, 46, 0.8);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 15px;
            padding: 25px;
            backdrop-filter: blur(10px);
        }

        .stats-panel h2 {
            color: #d4af37;
            margin-bottom: 20px;
            font-size: 1.5rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
        }

        .stat-item {
            background: rgba(15, 52, 96, 0.6);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .stat-value {
            font-size: 2rem;
            font-weight: 700;
            color: #d4af37;
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 0.9rem;
            color: #aaa;
        }

        /* Modal */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            backdrop-filter: blur(5px);
        }

        #spinResultOverlay {
            z-index: 999;
        }

        .modal-overlay.active {
            display: flex;
            animation: fadeIn 0.3s ease;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .modal {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border: 3px solid #d4af37;
            border-radius: 20px;
            padding: 40px;
            max-width: 500px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 50px rgba(212, 175, 55, 0.5);
            animation: slideUp 0.3s ease;
        }

        @keyframes slideUp {
            from {
                transform: translateY(50px);
                opacity: 0;
            }
            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .modal h2 {
            font-size: 2.5rem;
            color: #d4af37;
            margin-bottom: 20px;
            text-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
        }

        .modal-text {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 30px;
            color: #e0e0e0;
        }

        .modal-choices {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .choice-button {
            background: rgba(212, 175, 55, 0.2);
            border: 2px solid #d4af37;
            color: #d4af37;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .choice-button:hover {
            background: rgba(212, 175, 55, 0.3);
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.3);
        }

        /* Spin Result Modal */
        .spin-result-modal {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border: 3px solid #d4af37;
            border-radius: 20px;
            padding: 35px;
            max-width: 450px;
            width: 90%;
            text-align: center;
            box-shadow: 0 10px 50px rgba(212, 175, 55, 0.5);
            animation: slideUp 0.3s ease;
            position: relative;
        }

        .spin-result-modal.win {
            border-color: #4ade80;
            box-shadow: 0 10px 50px rgba(74, 222, 128, 0.4);
        }

        .spin-result-modal.loss {
            border-color: #fbbf24;
            box-shadow: 0 10px 50px rgba(251, 191, 36, 0.4);
        }

        .spin-result-modal h3 {
            font-size: 1.8rem;
            color: #d4af37;
            margin-bottom: 20px;
        }

        .spin-result-modal.win h3 {
            color: #4ade80;
        }

        .spin-result-modal.loss h3 {
            color: #fbbf24;
        }

        .spin-result-text {
            font-size: 1.1rem;
            line-height: 1.6;
            margin-bottom: 25px;
            color: #e0e0e0;
        }

        .spin-result-close {
            background: linear-gradient(135deg, #d4af37 0%, #ffd700 100%);
            border: none;
            color: #1a1a2e;
            padding: 12px 40px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .spin-result-close:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 20px rgba(212, 175, 55, 0.4);
        }

        /* Cause Details Modal */
        .cause-details-modal {
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            border: 3px solid #d4af37;
            border-radius: 20px;
            padding: 40px;
            max-width: 600px;
            width: 90%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 50px rgba(212, 175, 55, 0.5);
            animation: slideUp 0.3s ease;
            position: relative;
        }

        .cause-details-header {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 2px solid rgba(212, 175, 55, 0.3);
        }

        .cause-details-emoji {
            font-size: 4rem;
            margin-bottom: 15px;
            display: block;
        }

        .cause-details-title {
            font-size: 2rem;
            color: #d4af37;
            margin-bottom: 10px;
        }

        .cause-details-subtitle {
            color: #aaa;
            font-size: 1rem;
            font-style: italic;
        }

        .cause-details-content {
            margin-bottom: 30px;
        }

        .cause-details-section {
            margin-bottom: 25px;
        }

        .cause-details-section h4 {
            color: #ffd700;
            font-size: 1.2rem;
            margin-bottom: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .cause-details-section h4::before {
            content: '‚ñ∏';
            color: #d4af37;
            font-size: 1.3rem;
        }

        .cause-details-section p {
            line-height: 1.8;
            color: #e0e0e0;
            margin-bottom: 10px;
        }

        .cause-details-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-top: 20px;
        }

        .cause-stat-item {
            background: rgba(15, 52, 96, 0.5);
            border: 2px solid rgba(212, 175, 55, 0.2);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }

        .cause-stat-value {
            font-size: 1.8rem;
            font-weight: 700;
            color: #d4af37;
            margin-bottom: 5px;
        }

        .cause-stat-label {
            font-size: 0.9rem;
            color: #aaa;
        }

        .cause-details-actions {
            display: flex;
            gap: 15px;
            margin-top: 30px;
        }

        .cause-select-button {
            flex: 1;
            background: linear-gradient(135deg, #d4af37 0%, #ffd700 100%);
            border: none;
            color: #1a1a2e;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1.1rem;
            font-weight: 700;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .cause-select-button:hover {
            transform: scale(1.05);
            box-shadow: 0 5px 25px rgba(212, 175, 55, 0.5);
        }

        .cause-close-button {
            background: rgba(212, 175, 55, 0.2);
            border: 2px solid #d4af37;
            color: #d4af37;
            padding: 15px 30px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .cause-close-button:hover {
            background: rgba(212, 175, 55, 0.3);
            transform: scale(1.05);
        }

        .cause-option {
            position: relative;
        }

        .cause-info-icon {
            position: absolute;
            top: 10px;
            right: 10px;
            font-size: 0.9rem;
            color: #d4af37;
            opacity: 0.6;
            transition: opacity 0.3s ease;
        }

        .cause-option:hover .cause-info-icon {
            opacity: 1;
        }

        /* Complex Vault Slot Styles */
        .complex-slot-machine {
            background: rgba(26, 26, 46, 0.8);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 15px;
            padding: 30px;
            backdrop-filter: blur(10px);
            text-align: center;
        }

        .complex-slot-machine {
            position: relative;
            width: 100%;
        }
        
        .complex-grid-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 10px;
            margin: 20px auto;
            width: 90%;
            max-width: 600px;
            aspect-ratio: 5/3;
            position: relative;
            padding: 15px;
            background: rgba(15, 52, 96, 0.3);
            border-radius: 10px;
            border: 2px solid rgba(212, 175, 55, 0.2);
        }
        
        /* Ensure grid container doesn't show text content */
        .complex-grid-container::before,
        .complex-grid-container::after {
            display: none;
        }

        .complex-symbol-cell {
            aspect-ratio: 1;
            background: rgba(26, 26, 46, 0.8);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            transition: all 0.3s ease;
            width: 100%;
            height: 100%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 3rem;
        }

        .complex-symbol-cell.winning {
            border-color: #4ade80;
            box-shadow: 0 0 30px rgba(74, 222, 128, 0.8), 0 0 60px rgba(74, 222, 128, 0.4);
            animation: neonPulse 1s ease-in-out infinite;
        }

        @keyframes neonPulse {
            0%, 100% { 
                box-shadow: 0 0 30px rgba(74, 222, 128, 0.8), 0 0 60px rgba(74, 222, 128, 0.4);
            }
            50% { 
                box-shadow: 0 0 50px rgba(74, 222, 128, 1), 0 0 100px rgba(74, 222, 128, 0.6);
            }
        }

        /* Hide the strip - we'll show symbols directly in cells */
        .complex-symbol-strip {
            display: none;
        }
        
        /* Symbol display directly in cell */
        .complex-symbol-display {
            font-size: 3rem;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 100%;
            height: 100%;
        }

        .complex-symbol-cell.spinning .complex-symbol-display {
            filter: blur(3px);
            animation: spinGlow 0.3s ease-in-out infinite alternate;
        }

        .complex-symbol-cell.winning {
            border-color: #4ade80;
            box-shadow: 0 0 30px rgba(74, 222, 128, 0.8), 0 0 60px rgba(74, 222, 128, 0.4);
            animation: neonPulse 1s ease-in-out infinite;
        }

        @keyframes neonPulse {
            0%, 100% { 
                box-shadow: 0 0 30px rgba(74, 222, 128, 0.8), 0 0 60px rgba(74, 222, 128, 0.4);
            }
            50% { 
                box-shadow: 0 0 50px rgba(74, 222, 128, 1), 0 0 100px rgba(74, 222, 128, 0.6);
            }
        }

        .payline-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            pointer-events: none;
            z-index: 5;
        }

        .payline-path {
            stroke: rgba(74, 222, 128, 0.8);
            stroke-width: 3;
            fill: none;
            stroke-dasharray: 5,5;
            animation: paylineGlow 1s ease-in-out infinite;
        }

        @keyframes paylineGlow {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }

        .show-paylines-toggle {
            background: rgba(212, 175, 55, 0.2);
            border: 2px solid rgba(212, 175, 55, 0.4);
            color: #d4af37;
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            margin: 15px 0;
            transition: all 0.3s ease;
        }

        .show-paylines-toggle:hover {
            background: rgba(212, 175, 55, 0.3);
            transform: scale(1.05);
        }

        .show-paylines-toggle.active {
            background: rgba(212, 175, 55, 0.4);
            border-color: #d4af37;
        }

        .complex-win-summary {
            margin-top: 20px;
            padding: 15px;
            background: rgba(15, 52, 96, 0.5);
            border-radius: 10px;
            border: 2px solid rgba(212, 175, 55, 0.3);
        }

        .complex-win-summary.win {
            border-color: #4ade80;
            background: rgba(74, 222, 128, 0.1);
        }

        .complex-help-button {
            background: rgba(212, 175, 55, 0.2);
            border: 1px solid rgba(212, 175, 55, 0.4);
            color: #d4af37;
            padding: 8px 15px;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.85rem;
            margin-left: 10px;
        }
        
        /* Paylines Visualization */
        .paylines-visualization-container {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 8px;
            width: 100%;
            max-width: 500px;
            margin: 20px auto;
            aspect-ratio: 5/3;
            position: relative;
            padding: 15px;
            background: rgba(15, 52, 96, 0.3);
            border-radius: 10px;
            border: 2px solid rgba(212, 175, 55, 0.2);
        }
        
        .payline-visualization-cell {
            aspect-ratio: 1;
            background: rgba(26, 26, 46, 0.8);
            border: 2px solid rgba(212, 175, 55, 0.3);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 2.5rem;
            transition: all 0.3s ease;
        }
        
        .payline-visualization-cell.highlighted {
            border-color: #4ade80;
            box-shadow: 0 0 30px rgba(74, 222, 128, 0.8), 0 0 60px rgba(74, 222, 128, 0.4);
            animation: neonPulse 1s ease-in-out infinite;
            background: rgba(74, 222, 128, 0.2);
        }
        
        .payline-button {
            background: rgba(212, 175, 55, 0.2);
            border: 2px solid #d4af37;
            color: #d4af37;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.85rem;
            font-weight: 600;
            transition: all 0.3s ease;
            text-align: center;
        }
        
        .payline-button:hover {
            background: rgba(212, 175, 55, 0.3);
            transform: scale(1.05);
        }
        
        .payline-button.active {
            background: rgba(212, 175, 55, 0.5);
            border-color: #ffd700;
            box-shadow: 0 0 15px rgba(212, 175, 55, 0.6);
        }

        /* Mobile Responsive */
        @media (max-width: 767px) {
            h1 {
                font-size: 2.5rem;
            }

            .subtitle {
                font-size: 1.1rem;
            }

            .intro-section {
                padding: 25px 20px;
            }

            .intro-section h2 {
                font-size: 1.5rem;
            }

            .intro-block h3 {
                font-size: 1.1rem;
            }

            .intro-block p {
                font-size: 0.95rem;
            }

            .differentiator-item h4 {
                font-size: 1.1rem;
            }

            .cause-option {
                padding: 12px;
            }

            .cause-kpis {
                grid-template-columns: repeat(3, 1fr);
                gap: 8px;
            }

            .cause-kpi-label {
                font-size: 0.7rem;
            }

            .cause-kpi-value {
                font-size: 0.85rem;
            }

            .cause-kpi-value.multiplier {
                font-size: 1rem;
            }

            .cause-header {
                gap: 10px;
            }

            .cause-emoji {
                font-size: 1.5rem;
            }

            .cause-name {
                font-size: 1rem;
            }

            .cause-details-modal {
                padding: 25px 20px;
                max-height: 95vh;
            }

            .cause-details-emoji {
                font-size: 3rem;
            }

            .cause-details-title {
                font-size: 1.5rem;
            }

            .cause-details-stats {
                grid-template-columns: 1fr;
            }

            .cause-details-actions {
                flex-direction: column;
            }

            .reels-container {
                gap: 8px;
            }

            .reel {
                width: 60px;
                height: 75px;
            }

            .reel-symbol {
                height: 75px;
                font-size: 2.5rem;
            }

            .bet-section {
                padding: 15px;
                margin: 20px 0;
            }

            .bet-input {
                width: 140px;
                font-size: 1.2rem;
                padding: 10px 15px;
            }

            .bet-currency {
                font-size: 1.3rem;
            }

            .bet-info {
                flex-direction: column;
                gap: 8px;
                align-items: flex-start;
            }

            .spin-button {
                padding: 15px 40px;
                font-size: 1.2rem;
            }

            .game-rules {
                padding: 15px;
                margin-top: 20px;
            }

            .game-rules h3 {
                font-size: 1rem;
            }

            .rules-list li {
                font-size: 0.85rem;
                padding: 8px 0;
                padding-left: 25px;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }

            #tab-complex .game-section {
                grid-template-columns: 1fr !important;
            }

            .complex-grid-container {
                gap: 6px;
                padding: 15px;
            }

            .complex-symbol-cell {
                font-size: 2rem;
            }

            .complex-help-button {
                font-size: 0.75rem;
                padding: 6px 12px;
                margin-top: 10px;
            }

            #complexHelpOverlay .modal {
                max-width: 95% !important;
                max-height: 95vh !important;
                padding: 15px !important;
            }

            #complexHelpOverlay .modal-text {
                font-size: 0.85rem !important;
            }

            #complexHelpOverlay table {
                font-size: 0.75rem !important;
            }

            #complexHelpOverlay th,
            #complexHelpOverlay td {
                padding: 4px !important;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>Legends of the Vault</h1>
            <p class="subtitle">Explore the Vault. Build a Legacy.</p>
            <p class="disclaimer">Demo MVP ‚Äì No real money involved</p>
        </header>

        <!-- Intro Section -->
        <section class="intro-section">
            <h2>Vault of Causes</h2>
            <div class="intro-content">
                <div class="intro-block">
                    <h3>What is it</h3>
                    <p>A premium slot experience that combines proven slot mechanics with persistent progression and real-world impact themes. The player explores a legendary vault through episodic chapters, each linked to a meaningful cause.</p>
                </div>

                <div class="intro-block">
                    <h3>Theme & Fantasy</h3>
                    <p><strong>Cinematic archaeological adventure</strong> ‚Äì Opening vaults means uncovering legacy, not just rewards. Each session contributes to something that lasts beyond a single spin.</p>
                </div>

                <div class="intro-block">
                    <h3>Target Player</h3>
                    <p><strong>Mid-core slot players</strong> looking for:</p>
                    <ul>
                        <li>Premium visuals</li>
                        <li>Longer engagement</li>
                        <li>More meaning than "spin ‚Üí win/lose ‚Üí exit"</li>
                    </ul>
                </div>

                <div class="intro-block differentiators">
                    <h3>What Makes This Slot Different</h3>
                    <div class="differentiators-grid">
                        <div class="differentiator-item">
                            <span class="differentiator-number">1</span>
                            <h4>Progression that survives losing</h4>
                            <p>Even when players lose a spin, they still progress toward unlocking the vault. This reduces frustration and increases session length without changing core slot math.</p>
                        </div>
                        <div class="differentiator-item">
                            <span class="differentiator-number">2</span>
                            <h4>Player agency without complexity</h4>
                            <p>Players choose a cause and influence where impact is directed. No complex decisions per spin; agency appears at meaningful moments only.</p>
                        </div>
                        <div class="differentiator-item">
                            <span class="differentiator-number">3</span>
                            <h4>Emotional engagement, not just financial</h4>
                            <p>Traditional slots focus purely on monetary outcomes. This game adds an emotional reward loop, which increases retention and talkability.</p>
                        </div>
                        <div class="differentiator-item">
                            <span class="differentiator-number">4</span>
                            <h4>Premium positioning</h4>
                            <p>Cinematic art direction and sound design. Episodic structure enables live ops, seasonal chapters, and market-specific content.</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Tab Navigation -->
        <div class="tab-navigation">
            <button class="tab-button active" data-tab="basic">Basic Vault Slot</button>
            <button class="tab-button" data-tab="complex">Complex Vault Slot</button>
        </div>

        <!-- Tab 1: Basic Vault Slot (Current Production Code) -->
        <div class="tab-content active" id="tab-basic">
        <div class="game-section">
            <div class="slot-machine">
                <h2 style="color: #d4af37; margin-bottom: 20px;">The Vault</h2>
                <div class="reels-container" id="reelsContainer">
                    <div class="reel" id="reel1">
                        <div class="reel-strip" id="reelStrip1"></div>
                    </div>
                    <div class="reel" id="reel2">
                        <div class="reel-strip" id="reelStrip2"></div>
                    </div>
                    <div class="reel" id="reel3">
                        <div class="reel-strip" id="reelStrip3"></div>
                    </div>
                    <div class="reel" id="reel4">
                        <div class="reel-strip" id="reelStrip4"></div>
                    </div>
                    <div class="reel" id="reel5">
                        <div class="reel-strip" id="reelStrip5"></div>
                    </div>
                </div>
                
                <!-- Bet Input Section -->
                <div class="bet-section">
                    <label class="bet-label" for="betInput">Place Your Bet</label>
                    <div class="bet-input-container">
                        <span class="bet-currency">$</span>
                        <input 
                            type="number" 
                            id="betInput" 
                            class="bet-input" 
                            placeholder="0" 
                            min="1" 
                            max="10000" 
                            step="1"
                            value=""
                        >
                        <button class="bet-max-button" id="betMaxButton">MAX</button>
                    </div>
                    <div class="bet-info">
                        <span class="bet-amount-display" id="betAmountDisplay">Bet: $0</span>
                        <span>
                            <span class="bet-percentage" id="betPercentage">0%</span>
                            <span class="bet-percentage-label">to cause</span>
                        </span>
                    </div>
                </div>
                
                <button class="spin-button" id="spinButton" disabled>SPIN</button>
                <div class="result-message" id="resultMessage"></div>
                
                <!-- Game Rules -->
                <div class="game-rules">
                    <h3>Game Rules</h3>
                    <ul class="rules-list">
                        <li><strong>3+ matching symbols</strong> (any position) = <span style="color: #4ade80;">Victory!</span></li>
                        <li>Any other combination = Loss</li>
                        <li class="highlight"><strong>All 5 symbols match</strong> = 5x Prize Multiplier!</li>
                    </ul>
                </div>
            </div>

            <div class="cause-panel">
                <h2>Choose Your Cause</h2>
                <p style="color: #aaa; font-size: 0.9rem; margin-bottom: 15px; font-style: italic;">Click on any cause to learn more</p>
                <div class="causes" id="causesContainer">
                    <div class="cause-option" data-cause="reforest">
                        <div class="cause-header">
                        <span class="cause-emoji">üå±</span>
                        <span class="cause-name">Reforest City A</span>
                            <span class="cause-info-icon">‚ÑπÔ∏è</span>
                        </div>
                        <div class="cause-kpis">
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Progress</div>
                                <div class="cause-kpi-value" data-kpi="progress">2,847 trees</div>
                            </div>
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Target</div>
                                <div class="cause-kpi-value" data-kpi="target">10,000</div>
                            </div>
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Multiplier</div>
                                <div class="cause-kpi-value multiplier" data-kpi="multiplier">1.2x</div>
                            </div>
                        </div>
                    </div>
                    <div class="cause-option" data-cause="food">
                        <div class="cause-header">
                        <span class="cause-emoji">üçΩÔ∏è</span>
                        <span class="cause-name">Food Support Initiative B</span>
                            <span class="cause-info-icon">‚ÑπÔ∏è</span>
                        </div>
                        <div class="cause-kpis">
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Progress</div>
                                <div class="cause-kpi-value" data-kpi="progress">32,450 meals</div>
                            </div>
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Target</div>
                                <div class="cause-kpi-value" data-kpi="target">50,000/month</div>
                            </div>
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Multiplier</div>
                                <div class="cause-kpi-value multiplier" data-kpi="multiplier">1.0x</div>
                            </div>
                        </div>
                    </div>
                    <div class="cause-option" data-cause="ocean">
                        <div class="cause-header">
                            <span class="cause-emoji">üåä</span>
                            <span class="cause-name">Ocean Cleanup Program C</span>
                            <span class="cause-info-icon">‚ÑπÔ∏è</span>
                        </div>
                        <div class="cause-kpis">
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Progress</div>
                                <div class="cause-kpi-value" data-kpi="progress">67 tons</div>
                </div>
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Target</div>
                                <div class="cause-kpi-value" data-kpi="target">100 tons</div>
                            </div>
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Multiplier</div>
                                <div class="cause-kpi-value multiplier" data-kpi="multiplier">1.5x</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="progress-panel">
            <h2>Vault Progress</h2>
            <div class="progress-label">
                <span id="selectedCauseName">Select a cause to begin</span>
                <span id="progressText">0 / 100</span>
            </div>
            <div class="progress-bar-container">
                <div class="progress-bar" id="progressBar">
                    <div class="progress-percentage" id="progressPercentage">0%</div>
                </div>
            </div>
        </div>

        <div class="stats-panel">
            <h2>Session Stats</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-value" id="spinsPlayed">0</div>
                    <div class="stat-label">Spins Played</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="wins">0</div>
                    <div class="stat-label">Wins</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="vaultsUnlocked">0</div>
                    <div class="stat-label">Vaults Unlocked</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value" id="totalImpact">0</div>
                    <div class="stat-label">Total Impact Points</div>
                </div>
            </div>
        </div>
        </div>
        <!-- End Tab 1: Basic Vault Slot -->

        <!-- Tab 2: Complex Vault Slot -->
        <div class="tab-content" id="tab-complex">
            <!-- Cause Selection and Vault Side by Side -->
            <div class="game-section" style="margin-bottom: 30px; grid-template-columns: 2fr 1fr;">
            <!-- Complex Slot Machine (Left - Bigger) -->
            <div class="complex-slot-machine">
                <h2 style="color: #d4af37; margin-bottom: 20px;">The Vault</h2>
                
                <!-- Wallet Section -->
                <div class="wallet-section" style="background: rgba(15, 52, 96, 0.4); border: 2px solid rgba(212, 175, 55, 0.3); border-radius: 10px; padding: 15px; margin-bottom: 20px;">
                    <div style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                        <div style="display: flex; align-items: center; gap: 10px;">
                            <span style="font-size: 1.5rem;">üí∞</span>
                            <div>
                                <div style="color: #aaa; font-size: 0.85rem; margin-bottom: 5px;">Wallet Balance</div>
                                <div id="walletBalanceComplex" style="color: #4ade80; font-size: 1.5rem; font-weight: 700;">$0.00</div>
                            </div>
                        </div>
                        <button class="add-balance-button" id="addBalanceButtonComplex" style="background: rgba(212, 175, 55, 0.2); border: 2px solid #d4af37; color: #d4af37; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 0.9rem; font-weight: 600; transition: all 0.3s ease;">
                            + Add Balance
                        </button>
                    </div>
                </div>
                
                <!-- Bet Section -->
                <div class="bet-section">
                    <label class="bet-label" for="betInputComplex">Place Your Bet</label>
                    <div class="bet-input-container">
                        <span class="bet-currency">$</span>
                        <input 
                            type="number" 
                            id="betInputComplex" 
                            class="bet-input" 
                            placeholder="0" 
                            min="1" 
                            max="10000" 
                            step="1"
                            value=""
                        >
                        <button class="bet-max-button" id="betMaxButtonComplex">MAX</button>
                    </div>
                    <div class="bet-info">
                        <span class="bet-amount-display" id="betAmountDisplayComplex">Bet: $0</span>
                        <span>
                            <span class="bet-percentage" id="betPercentageComplex">0%</span>
                            <span class="bet-percentage-label">to cause</span>
                        </span>
                    </div>
                </div>

                <!-- 3x5 Grid -->
                <div class="complex-grid-container" id="complexGridContainer">
                    <!-- Grid cells will be generated by JavaScript -->
                    <svg class="payline-overlay" id="paylineOverlay" style="display: block;"></svg>
                </div>

                <!-- Win Summary -->
                <div class="complex-win-summary" id="complexWinSummary" style="display: none;">
                    <div id="complexWinMessage"></div>
                </div>

                <!-- Spin Button -->
                <button class="spin-button" id="spinButtonComplex" disabled>SPIN</button>

                <!-- Help Buttons -->
                <div style="display: flex; gap: 10px; justify-content: center; margin-top: 15px;">
                    <button class="complex-help-button" id="complexHelpButton">How Paylines Work</button>
                    <button class="complex-help-button" id="showPaylinesButton">Show Paylines Possible Wins</button>
                </div>
            </div>

            <!-- Cause Selection (Right) -->
            <div class="cause-panel">
                <h2>Choose Your Cause</h2>
                <p style="color: #aaa; font-size: 0.9rem; margin-bottom: 15px; font-style: italic;">Click on any cause to learn more</p>
                <div class="causes" id="causesContainerComplex">
                    <div class="cause-option" data-cause="reforest">
                        <div class="cause-header">
                            <span class="cause-emoji">üå±</span>
                            <span class="cause-name">Reforest City A</span>
                            <span class="cause-info-icon">‚ÑπÔ∏è</span>
                        </div>
                        <div class="cause-kpis">
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Progress</div>
                                <div class="cause-kpi-value" data-kpi="progress">2,847 trees</div>
                            </div>
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Target</div>
                                <div class="cause-kpi-value" data-kpi="target">10,000</div>
                            </div>
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Multiplier</div>
                                <div class="cause-kpi-value multiplier" data-kpi="multiplier">1.2x</div>
                            </div>
                        </div>
                    </div>
                    <div class="cause-option" data-cause="food">
                        <div class="cause-header">
                            <span class="cause-emoji">üçΩÔ∏è</span>
                            <span class="cause-name">Food Support Initiative B</span>
                            <span class="cause-info-icon">‚ÑπÔ∏è</span>
                        </div>
                        <div class="cause-kpis">
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Progress</div>
                                <div class="cause-kpi-value" data-kpi="progress">32,450 meals</div>
                            </div>
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Target</div>
                                <div class="cause-kpi-value" data-kpi="target">50,000/month</div>
                            </div>
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Multiplier</div>
                                <div class="cause-kpi-value multiplier" data-kpi="multiplier">1.0x</div>
                            </div>
                        </div>
                    </div>
                    <div class="cause-option" data-cause="ocean">
                        <div class="cause-header">
                            <span class="cause-emoji">üåä</span>
                            <span class="cause-name">Ocean Cleanup Program C</span>
                            <span class="cause-info-icon">‚ÑπÔ∏è</span>
                        </div>
                        <div class="cause-kpis">
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Progress</div>
                                <div class="cause-kpi-value" data-kpi="progress">67 tons</div>
                            </div>
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Target</div>
                                <div class="cause-kpi-value" data-kpi="target">100 tons</div>
                            </div>
                            <div class="cause-kpi-item">
                                <div class="cause-kpi-label">Multiplier</div>
                                <div class="cause-kpi-value multiplier" data-kpi="multiplier">1.5x</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            </div>
            <!-- End of side-by-side layout -->

            <!-- Progress and Stats (same as basic) -->
            <div class="progress-panel">
                <h2>Vault Progress</h2>
                <div class="progress-label">
                    <span id="selectedCauseNameComplex">Select a cause to begin</span>
                    <span id="progressTextComplex">0 / 100</span>
                </div>
                <div class="progress-bar-container">
                    <div class="progress-bar" id="progressBarComplex">
                        <div class="progress-percentage" id="progressPercentageComplex">0%</div>
                    </div>
                </div>
            </div>

            <div class="stats-panel">
                <h2>Session Stats</h2>
                <div class="stats-grid">
                    <div class="stat-item">
                        <div class="stat-value" id="spinsPlayedComplex">0</div>
                        <div class="stat-label">Spins Played</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="winsComplex">0</div>
                        <div class="stat-label">Wins</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="vaultsUnlockedComplex">0</div>
                        <div class="stat-label">Vaults Unlocked</div>
                    </div>
                    <div class="stat-item">
                        <div class="stat-value" id="totalImpactComplex">0</div>
                        <div class="stat-label">Total Impact Points</div>
                    </div>
                </div>
            </div>
        </div>
        <!-- End Tab 2: Complex Vault Slot -->
    </div>

    <!-- Spin Result Modal -->
    <div class="modal-overlay" id="spinResultOverlay">
        <div class="spin-result-modal" id="spinResultModal">
            <h3 id="spinResultTitle"></h3>
            <p class="spin-result-text" id="spinResultText"></p>
            <button class="spin-result-close" id="spinResultClose">Continue</button>
        </div>
    </div>

    <!-- Cause Details Modal -->
    <div class="modal-overlay" id="causeDetailsOverlay">
        <div class="cause-details-modal" id="causeDetailsModal">
            <div class="cause-details-header">
                <span class="cause-details-emoji" id="causeDetailsEmoji"></span>
                <h2 class="cause-details-title" id="causeDetailsTitle"></h2>
                <p class="cause-details-subtitle" id="causeDetailsSubtitle"></p>
            </div>
            <div class="cause-details-content" id="causeDetailsContent">
                <!-- Content will be populated by JavaScript -->
            </div>
            <div class="cause-details-actions">
                <button class="cause-close-button" id="causeDetailsClose">Close</button>
                <button class="cause-select-button" id="causeDetailsSelect">Select This Cause</button>
            </div>
        </div>
    </div>

    <!-- Complex Slot Help Modal -->
    <div class="modal-overlay" id="complexHelpOverlay">
        <div class="modal" style="max-width: 90%; max-width: 600px; max-height: 90vh; overflow-y: auto; padding: 20px; position: relative;">
            <button class="cause-close-button" style="position: absolute; top: 10px; right: 10px; padding: 8px 15px; font-size: 0.9rem;" onclick="document.getElementById('complexHelpOverlay').classList.remove('active')">‚úï</button>
            <h2 style="margin-top: 0;">How Paylines Work</h2>
            <div class="modal-text" style="text-align: left; font-size: 0.9rem; line-height: 1.6;">
                <p style="margin-bottom: 12px;"><strong>The Complex Vault Slot has 10 fixed paylines.</strong></p>
                <p style="margin-bottom: 15px;">A payline wins when it contains <strong>at least 3 identical symbols anywhere along that line</strong>. Order and position don't matter‚Äîonly the count of matching symbols.</p>
                
                <h3 style="color: #d4af37; margin-top: 15px; margin-bottom: 8px; font-size: 1rem;">How Betting Works:</h3>
                <p style="margin-bottom: 15px; font-size: 0.85rem;">
                    Your total bet is split equally across all 10 paylines.<br>
                    <strong>Bet per line = Total bet √∑ 10</strong>
                </p>
                
                <h3 style="color: #d4af37; margin-top: 15px; margin-bottom: 8px; font-size: 1rem;">Multiplier Table (applies to all symbols):</h3>
                <div style="overflow-x: auto; margin-bottom: 15px;">
                    <table style="width: 100%; border-collapse: collapse; font-size: 0.85rem;">
                        <thead>
                            <tr style="background: rgba(212, 175, 55, 0.2);">
                                <th style="padding: 8px; text-align: center; border: 1px solid rgba(212, 175, 55, 0.3);">Match Condition</th>
                                <th style="padding: 8px; text-align: center; border: 1px solid rgba(212, 175, 55, 0.3);">Multiplier</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td style="padding: 6px; text-align: center; border: 1px solid rgba(212, 175, 55, 0.2);">3 same symbols</td><td style="padding: 6px; text-align: center; border: 1px solid rgba(212, 175, 55, 0.2); font-weight: 700;">√ó1.2</td></tr>
                            <tr><td style="padding: 6px; text-align: center; border: 1px solid rgba(212, 175, 55, 0.2);">4 same symbols</td><td style="padding: 6px; text-align: center; border: 1px solid rgba(212, 175, 55, 0.2); font-weight: 700;">√ó2.5</td></tr>
                            <tr><td style="padding: 6px; text-align: center; border: 1px solid rgba(212, 175, 55, 0.2);">5 same symbols</td><td style="padding: 6px; text-align: center; border: 1px solid rgba(212, 175, 55, 0.2); font-weight: 700;">√ó3.5</td></tr>
                            <tr><td style="padding: 6px; text-align: center; border: 1px solid rgba(212, 175, 55, 0.2);">Special max combo (cause-aligned)</td><td style="padding: 6px; text-align: center; border: 1px solid rgba(212, 175, 55, 0.2); font-weight: 700; color: #4ade80;">√ó6.0</td></tr>
                        </tbody>
                    </table>
                </div>
                <p style="margin-top: 10px; font-size: 0.85rem; color: #aaa; font-style: italic;">
                    <strong>Special Max Combo:</strong> When all 5 symbols on a payline match your selected cause emoji, you get the special √ó6.0 multiplier!
                </p>
                
                <h3 style="color: #d4af37; margin-top: 15px; margin-bottom: 8px; font-size: 1rem;">Payout Calculation:</h3>
                <p style="background: rgba(212, 175, 55, 0.1); padding: 10px; border-radius: 5px; margin-bottom: 12px; font-size: 0.9rem;">
                    <strong>For each winning payline:</strong><br>
                    Line Payout = (Total Bet √∑ 10) √ó Multiplier<br><br>
                    <strong>Total Payout = Sum of all winning line payouts</strong>
                </p>
                <p style="margin-bottom: 12px; font-size: 0.9rem;"><strong>Example:</strong> If you bet $100 and win on 2 paylines:<br>
                Line 2: 4 identical symbols ‚Üí ($100 √∑ 10) √ó 2.5 = $25<br>
                Line 7: Special max combo ‚Üí ($100 √∑ 10) √ó 6.0 = $60<br>
                <strong>Total Payout: $85</strong><br>
                <em>Note: Most winning spins pay less than the total bet. This is normal slot behavior.</em></p>
                
                <p style="margin-top: 15px; color: #4ade80; font-size: 0.9rem;"><strong>üí° Tip:</strong> Click "Show Paylines" to see all 10 payline patterns!</p>
            </div>
            <button class="choice-button" id="complexHelpClose" style="width: 100%;">Got it!</button>
        </div>
    </div>

    <!-- Paylines Visualization Modal -->
    <div class="modal-overlay" id="paylinesVisualizationOverlay">
        <div class="modal" style="max-width: 90%; max-width: 800px; max-height: 90vh; overflow-y: auto; padding: 20px; position: relative;">
            <button class="cause-close-button" style="position: absolute; top: 10px; right: 10px; padding: 8px 15px; font-size: 0.9rem;" onclick="document.getElementById('paylinesVisualizationOverlay').classList.remove('active')">‚úï</button>
            <h2 style="margin-top: 0; color: #d4af37;">Paylines Possible Wins</h2>
            <p class="modal-text" style="margin-bottom: 20px; font-size: 0.9rem;">
                <strong>Win Condition:</strong> If a payline contains at least <strong>3 identical symbols anywhere along that line</strong>, you win a prize! Order and position don't matter‚Äîonly the count of matching symbols.
            </p>
            
            <!-- Visualization Grid -->
            <div class="paylines-visualization-container" id="paylinesVisualizationGrid">
                <!-- Grid will be generated by JavaScript -->
            </div>
            
            <!-- Payline Buttons -->
            <div class="paylines-buttons-container" id="paylinesButtonsContainer" style="margin-top: 20px; display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px;">
                <!-- Buttons will be generated by JavaScript -->
            </div>
            
            <p class="modal-text" style="margin-top: 20px; font-size: 0.85rem; color: #aaa; font-style: italic;">
                Click on any payline button above to see its pattern highlighted on the grid.
            </p>
        </div>
    </div>

    <!-- Vault Milestone Modal -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="modal">
            <h2>Vault Unlocked! üéâ</h2>
            <p class="modal-text" id="modalText">
                Your dedication has opened a new chamber in the Vault. The legacy you're building continues to grow, creating lasting impact for your chosen cause.
            </p>
            <div class="modal-choices">
                <button class="choice-button" data-amplify="5">Amplify this cause (+5%)</button>
                <button class="choice-button" data-amplify="10">Amplify this cause (+10%)</button>
                <button class="choice-button" data-amplify="0">Skip</button>
            </div>
        </div>
    </div>

    <script>
        // Game State
        const gameState = {
            selectedCause: null,
            betAmount: 0,
            impactPoints: 0,
            spinsPlayed: 0,
            wins: 0,
            vaultsUnlocked: 0,
            totalImpact: 0
        };

        // Donation percentage (5% of bet goes to cause)
        const DONATION_PERCENTAGE = 5;

        // Cause definitions with detailed information
        const causes = {
            reforest: {
                name: 'Reforest City A',
                emoji: 'üå±',
                subtitle: 'Urban Greening Initiative',
                description: 'Transform urban landscapes by planting native trees and restoring green spaces in City A. This initiative focuses on creating sustainable ecosystems that improve air quality, reduce urban heat, and provide habitats for local wildlife.',
                impact: 'Each spin contributes to planting trees and maintaining urban forests. Your progress helps fund tree planting programs, community gardens, and green infrastructure development.',
                goals: [
                    'Plant 10,000 native trees across the city',
                    'Create 50 new community green spaces',
                    'Reduce urban heat island effect by 15%',
                    'Improve air quality index by 20%'
                ],
                currentProgress: '2,847 trees planted',
                target: '10,000 trees',
                impactMultiplier: '1.2x'
            },
            food: {
                name: 'Food Support Initiative B',
                emoji: 'üçΩÔ∏è',
                subtitle: 'Community Nutrition Program',
                description: 'Address food insecurity by providing nutritious meals and food assistance to underserved communities in Region B. This program connects local food sources with families in need while supporting sustainable agriculture.',
                impact: 'Your spins help fund meal programs, food distribution centers, and nutrition education. Every contribution ensures families have access to healthy, culturally appropriate food options.',
                goals: [
                    'Serve 50,000 meals per month',
                    'Support 25 local food distribution centers',
                    'Provide nutrition education to 5,000 families',
                    'Reduce food waste by 30% through redistribution'
                ],
                currentProgress: '32,450 meals served',
                target: '50,000 meals/month',
                impactMultiplier: '1.0x'
            },
            ocean: {
                name: 'Ocean Cleanup Program C',
                emoji: 'üåä',
                subtitle: 'Marine Conservation Project',
                description: 'Protect marine ecosystems by removing plastic waste from oceans and coastlines. This program combines cleanup efforts with research and education to create lasting change in ocean health.',
                impact: 'Each spin funds cleanup operations, research initiatives, and educational programs. Your progress directly contributes to removing plastic from our oceans and preventing future pollution.',
                goals: [
                    'Remove 100 tons of plastic from oceans',
                    'Clean 50 miles of coastline',
                    'Deploy 20 ocean cleanup barriers',
                    'Educate 10,000 people about ocean conservation'
                ],
                currentProgress: '67 tons removed',
                target: '100 tons',
                impactMultiplier: '1.5x'
            }
        };

        // Symbols for reels
        const symbols = ['üé∞', 'üíé', 'üèÜ', '‚≠ê', 'üîÆ', 'üëë'];
        const REEL_COUNT = 5;

        // DOM Elements
        const causesContainer = document.getElementById('causesContainer');
        const spinButton = document.getElementById('spinButton');
        const reelsContainer = document.getElementById('reelsContainer');
        const resultMessage = document.getElementById('resultMessage');
        
        // Get symbol height dynamically
        function getSymbolHeight() {
            const firstReel = document.getElementById('reel1');
            if (firstReel) {
                return firstReel.offsetHeight;
            }
            // Fallback based on screen size
            return window.innerWidth < 768 ? 75 : 110;
        }
        
        // Initialize reel strips with symbols
        function initializeReels() {
            const symbolHeight = getSymbolHeight();
            
            for (let i = 1; i <= REEL_COUNT; i++) {
                const reelStrip = document.getElementById(`reelStrip${i}`);
                // Create multiple symbol instances for seamless scrolling
                // We need enough symbols to create a loop effect
                const symbolCount = 20; // Enough symbols for smooth scrolling
                reelStrip.innerHTML = '';
                
                // Start with a random symbol for variety
                const startOffset = Math.floor(Math.random() * symbols.length);
                
                for (let j = 0; j < symbolCount; j++) {
                    const symbolDiv = document.createElement('div');
                    symbolDiv.className = 'reel-symbol';
                    // Cycle through symbols to create variety, starting from random position
                    symbolDiv.textContent = symbols[(j + startOffset) % symbols.length];
                    reelStrip.appendChild(symbolDiv);
                }
                
                // Set initial position to show a random symbol centered
                const initialSymbolIndex = Math.floor(Math.random() * 5) + 2; // Show symbol 2-6
                reelStrip.style.transform = `translateY(-${initialSymbolIndex * symbolHeight}px)`;
            }
        }
        
        // Initialize KPIs from causes data
        function initializeKPIs() {
            Object.keys(causes).forEach(causeId => {
                const cause = causes[causeId];
                const causeOption = document.querySelector(`[data-cause="${causeId}"]`);
                if (causeOption) {
                    const progressEl = causeOption.querySelector('[data-kpi="progress"]');
                    const targetEl = causeOption.querySelector('[data-kpi="target"]');
                    const multiplierEl = causeOption.querySelector('[data-kpi="multiplier"]');
                    
                    if (progressEl) progressEl.textContent = cause.currentProgress;
                    if (targetEl) targetEl.textContent = cause.target;
                    if (multiplierEl) multiplierEl.textContent = cause.impactMultiplier;
                }
            });
        }
        
        // Tab switching functionality
        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        
        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const targetTab = button.dataset.tab;
                
                // Remove active class from all tabs and buttons
                tabButtons.forEach(btn => btn.classList.remove('active'));
                tabContents.forEach(content => content.classList.remove('active'));
                
                // Add active class to clicked tab
                button.classList.add('active');
                document.getElementById(`tab-${targetTab}`).classList.add('active');
            });
        });
        
        // Initialize reels on page load
        initializeReels();
        initializeKPIs();
        const progressBar = document.getElementById('progressBar');
        const progressPercentage = document.getElementById('progressPercentage');
        const progressText = document.getElementById('progressText');
        const selectedCauseName = document.getElementById('selectedCauseName');
        const modalOverlay = document.getElementById('modalOverlay');
        const modalText = document.getElementById('modalText');
        const spinResultOverlay = document.getElementById('spinResultOverlay');
        const spinResultModal = document.getElementById('spinResultModal');
        const spinResultTitle = document.getElementById('spinResultTitle');
        const spinResultText = document.getElementById('spinResultText');
        const spinResultClose = document.getElementById('spinResultClose');
        const causeDetailsOverlay = document.getElementById('causeDetailsOverlay');
        const causeDetailsModal = document.getElementById('causeDetailsModal');
        const causeDetailsEmoji = document.getElementById('causeDetailsEmoji');
        const causeDetailsTitle = document.getElementById('causeDetailsTitle');
        const causeDetailsSubtitle = document.getElementById('causeDetailsSubtitle');
        const causeDetailsContent = document.getElementById('causeDetailsContent');
        const causeDetailsClose = document.getElementById('causeDetailsClose');
        const causeDetailsSelect = document.getElementById('causeDetailsSelect');
        const betInput = document.getElementById('betInput');
        const betMaxButton = document.getElementById('betMaxButton');
        const betAmountDisplay = document.getElementById('betAmountDisplay');
        const betPercentage = document.getElementById('betPercentage');
        const statsElements = {
            spinsPlayed: document.getElementById('spinsPlayed'),
            wins: document.getElementById('wins'),
            vaultsUnlocked: document.getElementById('vaultsUnlocked'),
            totalImpact: document.getElementById('totalImpact')
        };

        // Update bet display and percentage
        function updateBetDisplay() {
            const bet = gameState.betAmount;
            const donationAmount = (bet * DONATION_PERCENTAGE) / 100;
            
            betAmountDisplay.textContent = `Bet: $${bet.toLocaleString()}`;
            betPercentage.textContent = `${DONATION_PERCENTAGE}%`;
            
            // Update spin button state
            updateSpinButtonState();
        }
        
        // Update spin button enabled/disabled state
        function updateSpinButtonState() {
            const hasCause = gameState.selectedCause !== null;
            const hasBet = gameState.betAmount > 0 && gameState.betAmount <= 10000;
            spinButton.disabled = !(hasCause && hasBet);
        }
        
        // Handle bet input
        function handleBetInput(value) {
            let bet = parseInt(value) || 0;
            
            // Validate and clamp to max
            if (bet > 10000) {
                bet = 10000;
                betInput.value = 10000;
            } else if (bet < 0) {
                bet = 0;
                betInput.value = '';
            }
            
            gameState.betAmount = bet;
            updateBetDisplay();
            saveState();
        }

        // Clear state on page load (fresh start every time)
        function clearState() {
            localStorage.removeItem('vaultGameState');
            // Reset game state to initial values
            gameState.selectedCause = null;
            gameState.betAmount = 0;
            gameState.impactPoints = 0;
            gameState.spinsPlayed = 0;
            gameState.wins = 0;
            gameState.vaultsUnlocked = 0;
            gameState.totalImpact = 0;
            betInput.value = '';
            updateUI();
        }

        // Save state to localStorage
        function saveState() {
            localStorage.setItem('vaultGameState', JSON.stringify(gameState));
        }

        // Show cause details modal
        function showCauseDetails(causeId) {
            const cause = causes[causeId];
            
            // Populate modal header
            causeDetailsEmoji.textContent = cause.emoji;
            causeDetailsTitle.textContent = cause.name;
            causeDetailsSubtitle.textContent = cause.subtitle;
            
            // Populate modal content
            causeDetailsContent.innerHTML = `
                <div class="cause-details-section">
                    <h4>About This Cause</h4>
                    <p>${cause.description}</p>
                </div>
                
                <div class="cause-details-section">
                    <h4>Your Impact</h4>
                    <p>${cause.impact}</p>
                </div>
                
                <div class="cause-details-section">
                    <h4>Goals & Progress</h4>
                    <ul style="list-style: none; padding-left: 0;">
                        ${cause.goals.map(goal => `<li style="padding: 8px 0; padding-left: 25px; position: relative; color: #e0e0e0; line-height: 1.6;"><span style="position: absolute; left: 0; color: #d4af37;">‚úì</span>${goal}</li>`).join('')}
                    </ul>
                </div>
                
                <div class="cause-details-stats">
                    <div class="cause-stat-item">
                        <div class="cause-stat-value">${cause.currentProgress}</div>
                        <div class="cause-stat-label">Current Progress</div>
                    </div>
                    <div class="cause-stat-item">
                        <div class="cause-stat-value">${cause.target}</div>
                        <div class="cause-stat-label">Target Goal</div>
                    </div>
                    <div class="cause-stat-item">
                        <div class="cause-stat-value">${cause.impactMultiplier}</div>
                        <div class="cause-stat-label">Impact Multiplier</div>
                    </div>
                    <div class="cause-stat-item">
                        <div class="cause-stat-value">Active</div>
                        <div class="cause-stat-label">Status</div>
                    </div>
                </div>
            `;
            
            // Store the cause ID for selection
            causeDetailsSelect.dataset.causeId = causeId;
            
            // Show modal
            causeDetailsOverlay.classList.add('active');
        }
        
        // Close cause details modal
        function closeCauseDetails() {
            causeDetailsOverlay.classList.remove('active');
        }
        
        // Select cause from modal
        function selectCauseFromModal(causeId) {
            // Check which tab is active
            const complexTab = document.getElementById('tab-complex');
            const isComplexMode = complexTab && complexTab.classList.contains('active');
            
            if (isComplexMode) {
                // Complex mode
                complexGameState.selectedCause = causeId;
                
                document.querySelectorAll('#causesContainerComplex .cause-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                const complexCauseOption = document.querySelector(`#causesContainerComplex [data-cause="${causeId}"]`);
                if (complexCauseOption) {
                    complexCauseOption.classList.add('selected');
                }
                
                document.getElementById('selectedCauseNameComplex').textContent = 
                    `${causes[causeId].emoji} ${causes[causeId].name}`;
                updateComplexSpinButtonState();
            } else {
                // Basic mode
                gameState.selectedCause = causeId;

                // Update UI
                document.querySelectorAll('.cause-option').forEach(opt => {
                    opt.classList.remove('selected');
                });
                const causeOption = document.querySelector(`[data-cause="${causeId}"]`);
                if (causeOption) {
                    causeOption.classList.add('selected');
                }

                selectedCauseName.textContent = `${causes[causeId].emoji} ${causes[causeId].name}`;

                // Update spin button state (requires both cause and bet)
                updateSpinButtonState();
                saveState();
            }
            
            closeCauseDetails();
        }

        // Initialize cause selection - show details modal on click
        causesContainer.addEventListener('click', (e) => {
            const causeOption = e.target.closest('.cause-option');
            if (!causeOption) return;

            const causeId = causeOption.dataset.cause;
            showCauseDetails(causeId);
        });
        
        // Cause details modal event listeners
        causeDetailsClose.addEventListener('click', closeCauseDetails);
        causeDetailsSelect.addEventListener('click', () => {
            const causeId = causeDetailsSelect.dataset.causeId;
            if (causeId) {
                selectCauseFromModal(causeId);
            }
        });
        
        // Close modal when clicking overlay
        causeDetailsOverlay.addEventListener('click', (e) => {
            if (e.target === causeDetailsOverlay) {
                closeCauseDetails();
            }
        });

        // Show spin result popup
        function showSpinResult(winResult) {
            const cause = causes[gameState.selectedCause];
            const donationAmount = (gameState.betAmount * DONATION_PERCENTAGE) / 100;
            const isWin = winResult.isWin;
            const multiplier = winResult.multiplier;
            const winType = winResult.type;
            
            if (isWin) {
                if (winType === 'jackpot') {
                    spinResultTitle.textContent = 'üé∞ JACKPOT! 5x Multiplier!';
                    spinResultText.textContent = `Incredible! All 5 symbols matched! You won with a 5x multiplier! We're donating $${donationAmount.toFixed(2)} (${DONATION_PERCENTAGE}% of your $${gameState.betAmount.toLocaleString()} bet) to ${cause.name}.`;
                } else {
                    spinResultTitle.textContent = 'You Won! üéâ';
                    spinResultText.textContent = `You won! We're donating $${donationAmount.toFixed(2)} (${DONATION_PERCENTAGE}% of your $${gameState.betAmount.toLocaleString()} bet) to ${cause.name}.`;
                }
                spinResultModal.classList.remove('loss');
                spinResultModal.classList.add('win');
            } else {
                spinResultTitle.textContent = 'Keep Trying';
                spinResultText.textContent = `Your spin didn't win this time, but we're still donating $${donationAmount.toFixed(2)} (${DONATION_PERCENTAGE}% of your $${gameState.betAmount.toLocaleString()} bet) to ${cause.name}.`;
                spinResultModal.classList.remove('win');
                spinResultModal.classList.add('loss');
            }
            
            spinResultOverlay.classList.add('active');
        }

        // Close spin result popup
        function closeSpinResult() {
            spinResultOverlay.classList.remove('active');
            
            // Check which tab is active
            const basicTab = document.getElementById('tab-basic');
            const complexTab = document.getElementById('tab-complex');
            
            if (complexTab && complexTab.classList.contains('active')) {
                // Complex mode
                if (complexGameState.impactPoints >= 100) {
                    setTimeout(() => {
                        unlockComplexVault();
                    }, 500);
                } else {
                    updateComplexSpinButtonState();
                    betInputComplex.disabled = false;
                }
            } else {
                // Basic mode
                if (gameState.impactPoints >= 100) {
                    setTimeout(() => {
                        unlockVault();
                    }, 500);
                } else {
                    updateSpinButtonState();
                    betInput.disabled = false;
                }
            }
        }

        // Spin a single reel with realistic animation
        function spinReel(reelIndex, targetSymbol, duration, delay) {
            return new Promise((resolve) => {
                setTimeout(() => {
                    const reel = document.getElementById(`reel${reelIndex + 1}`);
                    const reelStrip = document.getElementById(`reelStrip${reelIndex + 1}`);
                    const symbolHeight = getSymbolHeight();
                    
                    // Add spinning class for blur effect
                    reel.classList.add('spinning');
                    
                    // Get current position
                    const currentTransform = reelStrip.style.transform;
                    const currentY = currentTransform ? parseFloat(currentTransform.match(/-?\d+\.?\d*/)?.[0] || 0) : 0;
                    
                    // Calculate target position
                    // Find the target symbol in the strip
                    const symbolElements = reelStrip.querySelectorAll('.reel-symbol');
                    
                    // Find all occurrences of the target symbol
                    const targetIndices = [];
                    for (let i = 0; i < symbolElements.length; i++) {
                        if (symbolElements[i].textContent === targetSymbol) {
                            targetIndices.push(i);
                        }
                    }
                    
                    // Choose a target index that's far enough down for smooth spinning
                    // We want it to be at least 5 symbols down to ensure good spin effect
                    let targetIndex;
                    if (targetIndices.length > 0) {
                        // Find the first index that's at least 5 symbols down
                        targetIndex = targetIndices.find(idx => idx >= 5) || targetIndices[targetIndices.length - 1];
                    } else {
                        // If symbol not found, pick a random position
                        targetIndex = Math.floor(Math.random() * (symbolElements.length - 5)) + 5;
                    }
                    
                    // Calculate final position (center the target symbol in the visible area)
                    const finalY = -(targetIndex * symbolHeight);
                    
                    // Add extra spins for effect (at least 3 full rotations)
                    // We want enough spins to feel realistic but not too many
                    const extraSpins = 3 + Math.random() * 2; // 3-5 full spins
                    const totalDistance = -(extraSpins * symbolElements.length * symbolHeight) + finalY;
                    
                    // Animation with deceleration
                    const startTime = Date.now();
                    const startY = currentY;
                    const distance = totalDistance - startY;
                    
                    function animate() {
                        const elapsed = Date.now() - startTime;
                        const progress = Math.min(elapsed / duration, 1);
                        
                        // Easing function for deceleration (ease-out cubic)
                        const easeOutCubic = 1 - Math.pow(1 - progress, 3);
                        
                        const currentY = startY + (distance * easeOutCubic);
                        reelStrip.style.transform = `translateY(${currentY}px)`;
                        
                        if (progress < 1) {
                            requestAnimationFrame(animate);
                        } else {
                            // Ensure we're at the exact final position
                            reelStrip.style.transform = `translateY(${finalY}px)`;
                            
                            // Add a subtle bounce effect when stopping
                            reelStrip.style.transition = 'transform 0.2s cubic-bezier(0.68, -0.55, 0.265, 1.55)';
                            setTimeout(() => {
                                const bounceY = finalY - 5;
                                reelStrip.style.transform = `translateY(${bounceY}px)`;
                                setTimeout(() => {
                                    reelStrip.style.transform = `translateY(${finalY}px)`;
                                    reelStrip.style.transition = 'transform 0.1s linear';
                                    reel.classList.remove('spinning');
                                    resolve();
                                }, 100);
                            }, 10);
                        }
                    }
                    
                    requestAnimationFrame(animate);
                }, delay);
            });
        }

        // Spin function with cascading reel stops
        async function spin() {
            if (!gameState.selectedCause || gameState.betAmount <= 0) return;

            spinButton.disabled = true;
            betInput.disabled = true;
            resultMessage.textContent = '';
            resultMessage.className = 'result-message';

            // Generate random symbols for each reel
            const reelSymbols = [];
            for (let i = 0; i < REEL_COUNT; i++) {
                reelSymbols.push(symbols[Math.floor(Math.random() * symbols.length)]);
            }

            // Check for win: at least 3 matching symbols, or all 5 matching (5x multiplier)
            function checkWin(symbols) {
                const symbolCounts = {};
                symbols.forEach(symbol => {
                    symbolCounts[symbol] = (symbolCounts[symbol] || 0) + 1;
                });
                
                const counts = Object.values(symbolCounts);
                const maxCount = Math.max(...counts);
                
                // Check if all 5 symbols match (5x multiplier)
                if (maxCount === 5) {
                    return { isWin: true, multiplier: 5, type: 'jackpot' };
                }
                
                // Check if any symbol appears 3 or more times (regular win)
                if (maxCount >= 3) {
                    return { isWin: true, multiplier: 1, type: 'win' };
                }
                
                return { isWin: false, multiplier: 1, type: 'loss' };
            }

            const winResult = checkWin(reelSymbols);
            const isWin = winResult.isWin;
            const winMultiplier = winResult.multiplier;
            const winType = winResult.type;

            // Spin reels with cascading effect
            // Each reel starts slightly after the previous one and stops in sequence
            const baseDuration = 2000; // Base spin duration in ms
            const baseDelay = 100; // Delay between reel starts
            
            const spinPromises = [];
            for (let i = 0; i < REEL_COUNT; i++) {
                const delay = i * baseDelay;
                const duration = baseDuration + (i * 200); // Each reel spins slightly longer
                spinPromises.push(spinReel(i, reelSymbols[i], duration, delay));
            }

            // Wait for all reels to finish
            await Promise.all(spinPromises);

            // Small delay before showing results
            await new Promise(resolve => setTimeout(resolve, 300));

            gameState.spinsPlayed++;
            
            // Calculate donation amount (5% of bet)
            const donationAmount = (gameState.betAmount * DONATION_PERCENTAGE) / 100;
            
            // Impact points based on bet amount (scaled)
            // Win: 20 points per $100 bet, Loss: 5 points per $100 bet
            const baseImpact = gameState.betAmount / 100;
            let impactGained = 0;

            if (isWin) {
                // Apply multiplier for jackpot (all 5 matching)
                impactGained = Math.floor(baseImpact * 20 * winMultiplier);
                gameState.wins++;
                
                if (winType === 'jackpot') {
                    resultMessage.textContent = `üé∞ JACKPOT! 5x Multiplier! $${donationAmount.toFixed(2)} to cause!`;
                    resultMessage.classList.add('win');
                } else {
                    resultMessage.textContent = `üéâ Victory! $${donationAmount.toFixed(2)} to cause!`;
                    resultMessage.classList.add('win');
                }
            } else {
                impactGained = Math.floor(baseImpact * 5);
                resultMessage.textContent = `Legacy grows! $${donationAmount.toFixed(2)} to cause`;
                resultMessage.classList.add('loss');
            }

                gameState.impactPoints += impactGained;
                gameState.totalImpact += impactGained;
            
            // Re-enable bet input after spin
            betInput.disabled = false;

                updateProgress();
                updateStats();
                saveState();

                // Show spin result popup
                setTimeout(() => {
                    showSpinResult(winResult);
                }, 500);
        }

        // Event listeners for spin result modal
        spinResultClose.addEventListener('click', closeSpinResult);
        spinResultOverlay.addEventListener('click', (e) => {
            if (e.target === spinResultOverlay) {
                closeSpinResult();
            }
        });

        // Update progress bar
        function updateProgress() {
            const percentage = Math.min(gameState.impactPoints, 100);
            progressBar.style.width = `${percentage}%`;
            progressPercentage.textContent = `${percentage}%`;
            progressText.textContent = `${gameState.impactPoints} / 100`;
        }

        // Update stats
        function updateStats() {
            statsElements.spinsPlayed.textContent = gameState.spinsPlayed;
            statsElements.wins.textContent = gameState.wins;
            statsElements.vaultsUnlocked.textContent = gameState.vaultsUnlocked;
            statsElements.totalImpact.textContent = gameState.totalImpact;
        }

        // Unlock vault
        function unlockVault() {
            gameState.vaultsUnlocked++;
            const cause = causes[gameState.selectedCause];
            modalText.textContent = `Your dedication has opened a new chamber in the Vault. The legacy you're building continues to grow, creating lasting impact for ${cause.name}.`;
            modalOverlay.classList.add('active');
            updateStats();
        }

        // Handle modal choices (works for both basic and complex modes)
        modalOverlay.addEventListener('click', (e) => {
            const choiceButton = e.target.closest('.choice-button');
            if (!choiceButton) return;

            const amplify = parseInt(choiceButton.dataset.amplify);
            
            // Check which tab is active
            const complexTab = document.getElementById('tab-complex');
            const isComplexMode = complexTab && complexTab.classList.contains('active');
            
            if (isComplexMode) {
                // Complex mode
                // Visual feedback only (no actual logic needed for MVP)
                if (amplify > 0) {
                    console.log(`Amplified cause by ${amplify}%`);
                }

                // Reset progress and close modal
                complexGameState.impactPoints = 0;
                updateComplexProgress();
                modalOverlay.classList.remove('active');
                spinButtonComplex.disabled = false;
                betInputComplex.disabled = false;
            } else {
                // Basic mode
                // Visual feedback only (no actual logic needed for MVP)
                if (amplify > 0) {
                    console.log(`Amplified cause by ${amplify}%`);
                }

                // Reset progress and close modal
                gameState.impactPoints = 0;
                updateProgress();
                modalOverlay.classList.remove('active');
                spinButton.disabled = false;
                saveState();
            }
        });

        // Bet input event listeners
        betInput.addEventListener('input', (e) => {
            handleBetInput(e.target.value);
        });
        
        betInput.addEventListener('blur', (e) => {
            if (!e.target.value || e.target.value === '0') {
                e.target.value = '';
                gameState.betAmount = 0;
                updateBetDisplay();
            }
        });
        
        betMaxButton.addEventListener('click', () => {
            betInput.value = 10000;
            handleBetInput(10000);
        });

        // Spin button event
        spinButton.addEventListener('click', spin);

        // Initialize UI
        function updateUI() {
            // Clear cause selection UI
            document.querySelectorAll('.cause-option').forEach(opt => {
                opt.classList.remove('selected');
            });
            selectedCauseName.textContent = 'Select a cause to begin';
            
            // Reset bet display
            betInput.value = '';
            gameState.betAmount = 0;
            updateBetDisplay();

            updateProgress();
            updateStats();
        }

        // Clear state on page load (fresh start every time)
        clearState();

        // ============================================
        // COMPLEX VAULT SLOT - Tab 2
        // ============================================

        // Complex Slot Symbols with Multipliers and Frequency Weights
        // Complex slot symbols - includes cause emojis
        const complexSymbols = {
            'üå±': { name: 'Reforest', frequency: 15, isCause: true },
            'üçΩÔ∏è': { name: 'Food Support', frequency: 14, isCause: true },
            'üåä': { name: 'Ocean Cleanup', frequency: 13, isCause: true },
            'üß≠': { name: 'Compass', frequency: 12, isCause: false },
            'üè∫': { name: 'Coin', frequency: 11, isCause: false },
            'üåç': { name: 'Globe', frequency: 10, isCause: false },
            'üóùÔ∏è': { name: 'Key', frequency: 8, isCause: false },
            '‚≠ê': { name: 'Legacy Star', frequency: 5, isCause: false },
            'üíé': { name: 'Vault Gem', frequency: 3, isCause: false }
        };

        // Create weighted symbol array for random selection
        const complexSymbolWeightedArray = [];
        Object.keys(complexSymbols).forEach(symbol => {
            for (let i = 0; i < complexSymbols[symbol].frequency; i++) {
                complexSymbolWeightedArray.push(symbol);
            }
        });

        const complexSymbolArray = Object.keys(complexSymbols); // Keep for compatibility
        const GRID_ROWS = 3;
        const GRID_COLS = 5;

        // 10 Fixed Paylines (row, col format, 0-indexed internally)
        const PAYLINES = [
            // Line 1: Middle row straight
            [[1,0], [1,1], [1,2], [1,3], [1,4]],
            // Line 2: Top row straight
            [[0,0], [0,1], [0,2], [0,3], [0,4]],
            // Line 3: Bottom row straight
            [[2,0], [2,1], [2,2], [2,3], [2,4]],
            // Line 4: V shape
            [[0,0], [1,1], [2,2], [1,3], [0,4]],
            // Line 5: Inverted V
            [[2,0], [1,1], [0,2], [1,3], [2,4]],
            // Line 6: Upper zig-zag
            [[1,0], [0,1], [0,2], [0,3], [1,4]],
            // Line 7: Lower zig-zag
            [[1,0], [2,1], [2,2], [2,3], [1,4]],
            // Line 8: Diagonal down-right
            [[0,0], [0,1], [1,2], [2,3], [2,4]],
            // Line 9: Diagonal up-right
            [[2,0], [2,1], [1,2], [0,3], [0,4]],
            // Line 10: Center zig-zag
            [[1,0], [1,1], [0,2], [1,3], [1,4]]
        ];

        // Complex Slot Game State
        const complexGameState = {
            selectedCause: null,
            betAmount: 0,
            impactPoints: 0,
            spinsPlayed: 0,
            wins: 0,
            vaultsUnlocked: 0,
            totalImpact: 0,
            walletBalance: 0, // Starting balance
            grid: Array(GRID_ROWS).fill(null).map(() => Array(GRID_COLS).fill(null))
        };
        
        // Load wallet balance from localStorage
        function loadWalletBalance() {
            const saved = localStorage.getItem('complexWalletBalance');
            if (saved !== null) {
                complexGameState.walletBalance = parseFloat(saved) || 0;
            }
            updateWalletDisplay();
        }
        
        // Save wallet balance to localStorage
        function saveWalletBalance() {
            localStorage.setItem('complexWalletBalance', complexGameState.walletBalance.toString());
        }
        
        // Update wallet display
        function updateWalletDisplay() {
            const walletDisplay = document.getElementById('walletBalanceComplex');
            if (walletDisplay) {
                walletDisplay.textContent = `$${complexGameState.walletBalance.toFixed(2)}`;
            }
        }

        // Complex Slot DOM Elements
        const complexGridContainer = document.getElementById('complexGridContainer');
        const spinButtonComplex = document.getElementById('spinButtonComplex');
        const betInputComplex = document.getElementById('betInputComplex');
        const betMaxButtonComplex = document.getElementById('betMaxButtonComplex');
        const betAmountDisplayComplex = document.getElementById('betAmountDisplayComplex');
        const betPercentageComplex = document.getElementById('betPercentageComplex');
        const paylineOverlay = document.getElementById('paylineOverlay');
        const complexWinSummary = document.getElementById('complexWinSummary');
        const complexWinMessage = document.getElementById('complexWinMessage');
        const causesContainerComplex = document.getElementById('causesContainerComplex');

        // Initialize Complex Grid - Simple one icon per cell
        function initializeComplexGrid() {
            // Clear container completely
            complexGridContainer.innerHTML = '';
            complexGridContainer.textContent = '';
            
            // Create grid cells - simple one icon per cell
            for (let row = 0; row < GRID_ROWS; row++) {
                for (let col = 0; col < GRID_COLS; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'complex-symbol-cell';
                    cell.id = `cell-${row}-${col}`;
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    
                    // Set initial random symbol in grid state
                    const randomSymbol = complexSymbolWeightedArray[Math.floor(Math.random() * complexSymbolWeightedArray.length)];
                    complexGameState.grid[row][col] = randomSymbol;
                    
                    // Create simple symbol display (one icon per cell)
                    const symbolDisplay = document.createElement('div');
                    symbolDisplay.className = 'complex-symbol-display';
                    symbolDisplay.id = `symbol-${row}-${col}`;
                    symbolDisplay.textContent = randomSymbol;
                    
                    cell.appendChild(symbolDisplay);
                    complexGridContainer.appendChild(cell);
                }
            }
            
            // Create SVG overlay for paylines (after cells are added, positioned absolutely)
            const svg = document.createElementNS('http://www.w3.org/2000/svg', 'svg');
            svg.className = 'payline-overlay';
            svg.id = 'paylineOverlay';
            svg.style.display = 'block';
            svg.style.position = 'absolute';
            svg.style.top = '0';
            svg.style.left = '0';
            svg.style.width = '100%';
            svg.style.height = '100%';
            svg.style.pointerEvents = 'none';
            svg.style.zIndex = '10';
            complexGridContainer.appendChild(svg);
            
            // Verify all 15 cells were created
            const createdCells = complexGridContainer.querySelectorAll('.complex-symbol-cell');
            if (createdCells.length !== 15) {
                console.error(`Grid initialization error: Expected 15 cells, found ${createdCells.length}`);
            }
            
            // Draw paylines after grid is initialized
            setTimeout(() => {
                drawPaylines([]);
            }, 200);
        }

        // Fixed multiplier table (same for all symbols)
        const MULTIPLIER_TABLE = {
            3: 1.2,  // 3 same symbols = √ó1.2
            4: 2.5,  // 4 same symbols = √ó2.5
            5: 3.5   // 5 same symbols = √ó3.5
        };
        
        // Special max combo multiplier (cause-aligned or rare pattern)
        const SPECIAL_MAX_COMBO_MULTIPLIER = 6.0;
        
        // Check payline for win (3+ identical symbols anywhere on the line, order doesn't matter)
        function checkPayline(payline) {
            // Get all symbols on this payline
            const symbols = payline.map(([row, col]) => complexGameState.grid[row][col]);
            
            // Count frequency of each symbol
            const symbolCounts = {};
            symbols.forEach(symbol => {
                symbolCounts[symbol] = (symbolCounts[symbol] || 0) + 1;
            });
            
            // Find the symbol with the highest count
            let maxCount = 0;
            let winningSymbol = null;
            for (const [symbol, count] of Object.entries(symbolCounts)) {
                if (count > maxCount) {
                    maxCount = count;
                    winningSymbol = symbol;
                }
            }
            
            // Check for special max combo: all 5 symbols match the selected cause emoji
            let isSpecialMaxCombo = false;
            if (complexGameState.selectedCause && maxCount === 5) {
                const causeEmoji = causes[complexGameState.selectedCause].emoji;
                if (winningSymbol === causeEmoji) {
                    isSpecialMaxCombo = true;
                }
            }
            
            // Win if highest count is 3 or more
            if (maxCount >= 3) {
                return {
                    wins: true,
                    matchCount: maxCount,
                    symbol: winningSymbol,
                    isSpecialMaxCombo: isSpecialMaxCombo
                };
            }
            return { wins: false, matchCount: 0, symbol: null, isSpecialMaxCombo: false };
        }

        // Check all paylines and return winning ones
        function checkAllPaylines() {
            const winningPaylines = [];
            PAYLINES.forEach((payline, index) => {
                const result = checkPayline(payline);
                if (result.wins) {
                    // Use special max combo multiplier if applicable, otherwise use standard multiplier
                    let multiplier;
                    if (result.isSpecialMaxCombo) {
                        multiplier = SPECIAL_MAX_COMBO_MULTIPLIER;
                    } else {
                        multiplier = MULTIPLIER_TABLE[result.matchCount];
                    }
                    winningPaylines.push({
                        lineNumber: index + 1,
                        positions: payline,
                        symbol: result.symbol,
                        matchCount: result.matchCount,
                        multiplier: multiplier,
                        isSpecialMaxCombo: result.isSpecialMaxCombo
                    });
                }
            });
            return winningPaylines;
        }

        // Calculate payout
        function calculatePayout(winningPaylines, betAmount) {
            const betPerLine = betAmount / 10; // 10 paylines
            let totalPayout = 0;
            
            winningPaylines.forEach(win => {
                // Payout = bet_per_line √ó multiplier (no bet back included)
                const linePayout = betPerLine * win.multiplier;
                totalPayout += linePayout;
            });
            
            return totalPayout;
        }

        // Draw paylines on SVG overlay
        function drawPaylines(winningPaylines = []) {
            const svg = paylineOverlay;
            svg.innerHTML = '';
            
            // Get actual grid container dimensions
            const containerRect = complexGridContainer.getBoundingClientRect();
            svg.setAttribute('width', containerRect.width);
            svg.setAttribute('height', containerRect.height);
            svg.setAttribute('viewBox', `0 0 ${containerRect.width} ${containerRect.height}`);
            
            PAYLINES.forEach((payline, index) => {
                const isWinning = winningPaylines.some(w => w.lineNumber === index + 1);
                const path = document.createElementNS('http://www.w3.org/2000/svg', 'path');
                
                let pathData = '';
                payline.forEach(([row, col], i) => {
                    const cell = document.getElementById(`cell-${row}-${col}`);
                    if (cell) {
                        const cellRect = cell.getBoundingClientRect();
                        const containerRect = complexGridContainer.getBoundingClientRect();
                        const x = cellRect.left - containerRect.left + cellRect.width / 2;
                        const y = cellRect.top - containerRect.top + cellRect.height / 2;
                        if (i === 0) {
                            pathData = `M ${x} ${y}`;
                        } else {
                            pathData += ` L ${x} ${y}`;
                        }
                    }
                });
                
                path.setAttribute('d', pathData);
                path.setAttribute('class', 'payline-path');
                if (isWinning) {
                    path.setAttribute('stroke', '#4ade80');
                    path.setAttribute('stroke-width', '4');
                } else {
                    path.setAttribute('stroke', 'rgba(212, 175, 55, 0.4)');
                    path.setAttribute('stroke-width', '2');
                }
                svg.appendChild(path);
            });
        }

        // Paylines are now always visible - drawn in initializeComplexGrid

        // Complex Slot Spin Function - Simple icon change animation
        async function spinComplex() {
            if (!complexGameState.selectedCause || complexGameState.betAmount <= 0) return;
            
            // Check if player has enough balance
            if (complexGameState.walletBalance < complexGameState.betAmount) {
                alert(`Insufficient balance! You need $${complexGameState.betAmount.toFixed(2)} but only have $${complexGameState.walletBalance.toFixed(2)}.`);
                return;
            }
            
            // Store bet amount for later (we'll handle deduction after calculating payout)
            const betAmount = complexGameState.betAmount;

            spinButtonComplex.disabled = true;
            betInputComplex.disabled = true;
            complexWinSummary.style.display = 'none';

            // Animate spinning for each cell - simple icon change
            const spinPromises = [];
            for (let row = 0; row < GRID_ROWS; row++) {
                for (let col = 0; col < GRID_COLS; col++) {
                    const cell = document.getElementById(`cell-${row}-${col}`);
                    const symbolDisplay = document.getElementById(`symbol-${row}-${col}`);
                    
                    if (!cell || !symbolDisplay) continue;
                    
                    cell.classList.add('spinning');
                    
                    // Generate target symbol using weighted selection
                    const targetSymbol = complexSymbolWeightedArray[Math.floor(Math.random() * complexSymbolWeightedArray.length)];
                    complexGameState.grid[row][col] = targetSymbol;
                    
                    // Animate icon changes with random symbols during spin
                    const duration = 1500 + (row * 100) + (col * 50);
                    const delay = (row * 50) + (col * 30);
                    const changeInterval = 100; // Change icon every 100ms during spin
                    
                    spinPromises.push(new Promise(resolve => {
                        setTimeout(() => {
                            const startTime = Date.now();
                            let lastChange = 0;
                            
                            function animate() {
                                const elapsed = Date.now() - startTime;
                                const progress = Math.min(elapsed / duration, 1);
                                
                                // Change icon periodically during spin
                                if (elapsed - lastChange >= changeInterval) {
                                    const randomSymbol = complexSymbolWeightedArray[Math.floor(Math.random() * complexSymbolWeightedArray.length)];
                                    symbolDisplay.textContent = randomSymbol;
                                    lastChange = elapsed;
                                }
                                
                                if (progress < 1) {
                                    requestAnimationFrame(animate);
                                } else {
                                    // Set final symbol
                                    symbolDisplay.textContent = targetSymbol;
                                    cell.classList.remove('spinning');
                                    resolve();
                                }
                            }
                            requestAnimationFrame(animate);
                        }, delay);
                    }));
                }
            }

            // Wait for all animations
            await Promise.all(spinPromises);

            // Check for wins
            const winningPaylines = checkAllPaylines();
            const isWin = winningPaylines.length > 0;
            
            complexGameState.spinsPlayed++;

            // Always update paylines after spin
            setTimeout(() => drawPaylines(winningPaylines), 100);

            if (isWin) {
                const totalPayout = calculatePayout(winningPaylines, betAmount);
                const donationAmount = (betAmount * DONATION_PERCENTAGE) / 100;
                
                // Add payout to wallet (payout is already net: bet_per_line √ó multiplier)
                // Then deduct the bet to get final net result
                complexGameState.walletBalance += totalPayout;
                complexGameState.walletBalance -= betAmount; // Deduct the bet
                updateWalletDisplay();
                saveWalletBalance();
                
                // Highlight winning cells with neon effect
                winningPaylines.forEach(win => {
                    win.positions.forEach(([row, col]) => {
                        const cell = document.getElementById(`cell-${row}-${col}`);
                        if (cell) {
                            cell.classList.add('winning');
                            // Keep neon effect for longer
                            setTimeout(() => cell.classList.remove('winning'), 3000);
                        }
                    });
                });

                // Update impact points (scaled)
                const baseImpact = complexGameState.betAmount / 100;
                const impactGained = Math.floor(baseImpact * 20 * winningPaylines.length);
                complexGameState.impactPoints += impactGained;
                complexGameState.totalImpact += impactGained;
                complexGameState.wins++;
                
                // Show spin result popup
                setTimeout(() => {
                    showComplexSpinResult(true, winningPaylines, totalPayout, donationAmount);
                }, 500);
            } else {
                // No win - deduct the bet amount
                complexGameState.walletBalance -= betAmount;
                updateWalletDisplay();
                saveWalletBalance();
                
                const donationAmount = (betAmount * DONATION_PERCENTAGE) / 100;
                const baseImpact = complexGameState.betAmount / 100;
                const impactGained = Math.floor(baseImpact * 5);
                complexGameState.impactPoints += impactGained;
                complexGameState.totalImpact += impactGained;

                // Show spin result popup
                setTimeout(() => {
                    showComplexSpinResult(false, [], 0, donationAmount);
                }, 500);
            }

            // Update UI
            updateComplexProgress();
            updateComplexStats();
            betInputComplex.disabled = false;
            updateComplexSpinButtonState();

            // Check for vault unlock
            if (complexGameState.impactPoints >= 100) {
                setTimeout(() => {
                    unlockComplexVault();
                }, 1000);
            }
        }

        // Complex Slot Helper Functions
        function updateComplexBetDisplay() {
            const bet = complexGameState.betAmount;
            betAmountDisplayComplex.textContent = `Bet: $${bet.toLocaleString()}`;
            betPercentageComplex.textContent = `${DONATION_PERCENTAGE}%`;
            updateComplexSpinButtonState();
            updateWalletDisplay(); // Update wallet display when bet changes
        }

        function updateComplexSpinButtonState() {
            const hasCause = complexGameState.selectedCause !== null;
            const hasBet = complexGameState.betAmount > 0 && complexGameState.betAmount <= 10000;
            spinButtonComplex.disabled = !(hasCause && hasBet);
        }

        function updateComplexProgress() {
            const percentage = Math.min(complexGameState.impactPoints, 100);
            document.getElementById('progressBarComplex').style.width = `${percentage}%`;
            document.getElementById('progressPercentageComplex').textContent = `${percentage}%`;
            document.getElementById('progressTextComplex').textContent = `${complexGameState.impactPoints} / 100`;
        }

        function updateComplexStats() {
            document.getElementById('spinsPlayedComplex').textContent = complexGameState.spinsPlayed;
            document.getElementById('winsComplex').textContent = complexGameState.wins;
            document.getElementById('vaultsUnlockedComplex').textContent = complexGameState.vaultsUnlocked;
            document.getElementById('totalImpactComplex').textContent = complexGameState.totalImpact;
        }

        // Show complex spin result popup (like basic vault)
        function showComplexSpinResult(isWin, winningPaylines, totalPayout, donationAmount) {
            const cause = causes[complexGameState.selectedCause];
            const spinResultTitle = document.getElementById('spinResultTitle');
            const spinResultText = document.getElementById('spinResultText');
            const spinResultModal = document.getElementById('spinResultModal');
            const spinResultOverlay = document.getElementById('spinResultOverlay');
            
            if (isWin) {
                const winDetails = winningPaylines.map(win => 
                    `Line ${win.lineNumber}: ${win.matchCount}√ó ${win.symbol} (√ó${win.multiplier})`
                ).join(' | ');
                
                spinResultTitle.textContent = 'You Won! üéâ';
                spinResultText.innerHTML = `
                    You won on ${winningPaylines.length} payline${winningPaylines.length > 1 ? 's' : ''}!<br>
                    <strong style="color: #ffd700;">Total Payout: $${totalPayout.toFixed(2)}</strong><br><br>
                    ${winDetails}<br><br>
                    We're donating $${donationAmount.toFixed(2)} (${DONATION_PERCENTAGE}% of your $${complexGameState.betAmount.toLocaleString()} bet) to ${cause.name}.
                `;
                spinResultModal.classList.remove('loss');
                spinResultModal.classList.add('win');
            } else {
                spinResultTitle.textContent = 'Keep Trying';
                spinResultText.textContent = `Your spin didn't win this time, but we're still donating $${donationAmount.toFixed(2)} (${DONATION_PERCENTAGE}% of your $${complexGameState.betAmount.toLocaleString()} bet) to ${cause.name}.`;
                spinResultModal.classList.remove('win');
                spinResultModal.classList.add('loss');
            }
            
            spinResultOverlay.classList.add('active');
        }

        // Close complex spin result
        function closeComplexSpinResult() {
            const spinResultOverlay = document.getElementById('spinResultOverlay');
            spinResultOverlay.classList.remove('active');
            
            // Check for vault unlock
            if (complexGameState.impactPoints >= 100) {
                setTimeout(() => {
                    unlockComplexVault();
                }, 500);
            } else {
                updateComplexSpinButtonState();
                betInputComplex.disabled = false;
            }
        }

        function unlockComplexVault() {
            complexGameState.vaultsUnlocked++;
            const cause = causes[complexGameState.selectedCause];
            modalText.textContent = `Your dedication has opened a new chamber in the Vault. The legacy you're building continues to grow, creating lasting impact for ${cause.name}.`;
            modalOverlay.classList.add('active');
            updateComplexStats();
        }

        // Complex Slot Event Listeners
        betInputComplex.addEventListener('input', (e) => {
            let bet = parseInt(e.target.value) || 0;
            if (bet > 10000) {
                bet = 10000;
                betInputComplex.value = 10000;
            }
            if (bet > complexGameState.walletBalance) {
                bet = complexGameState.walletBalance;
                betInputComplex.value = complexGameState.walletBalance;
            }
            complexGameState.betAmount = bet;
            updateComplexBetDisplay();
        });

        betMaxButtonComplex.addEventListener('click', () => {
            const maxBet = Math.min(10000, complexGameState.walletBalance);
            betInputComplex.value = maxBet;
            complexGameState.betAmount = maxBet;
            updateComplexBetDisplay();
        });
        
        // Add Balance Button
        const addBalanceButtonComplex = document.getElementById('addBalanceButtonComplex');
        addBalanceButtonComplex.addEventListener('click', () => {
            const amount = prompt('Enter amount to add to wallet (max $10,000):', '1000');
            if (amount !== null) {
                const addAmount = parseFloat(amount);
                if (isNaN(addAmount) || addAmount <= 0) {
                    alert('Please enter a valid positive number.');
                    return;
                }
                if (addAmount > 10000) {
                    alert('Maximum amount is $10,000.');
                    return;
                }
                complexGameState.walletBalance += addAmount;
                updateWalletDisplay();
                saveWalletBalance();
                updateComplexSpinButtonState();
            }
        });

        spinButtonComplex.addEventListener('click', spinComplex);

        // Complex Cause Selection - show popup like basic mode
        causesContainerComplex.addEventListener('click', (e) => {
            const causeOption = e.target.closest('.cause-option');
            if (!causeOption) return;
            
            const causeId = causeOption.dataset.cause;
            // Show cause details modal (reuse the same modal system)
            showCauseDetails(causeId);
        });

        // Complex Help Modal
        const complexHelpButton = document.getElementById('complexHelpButton');
        const complexHelpOverlay = document.getElementById('complexHelpOverlay');
        const complexHelpClose = document.getElementById('complexHelpClose');

        complexHelpButton.addEventListener('click', () => {
            complexHelpOverlay.classList.add('active');
        });

        complexHelpClose.addEventListener('click', () => {
            complexHelpOverlay.classList.remove('active');
        });
        
        // Paylines Visualization
        const showPaylinesButton = document.getElementById('showPaylinesButton');
        const paylinesVisualizationOverlay = document.getElementById('paylinesVisualizationOverlay');
        const paylinesVisualizationGrid = document.getElementById('paylinesVisualizationGrid');
        const paylinesButtonsContainer = document.getElementById('paylinesButtonsContainer');
        
        // Initialize paylines visualization
        function initializePaylinesVisualization() {
            // Create visualization grid
            paylinesVisualizationGrid.innerHTML = '';
            for (let row = 0; row < GRID_ROWS; row++) {
                for (let col = 0; col < GRID_COLS; col++) {
                    const cell = document.createElement('div');
                    cell.className = 'payline-visualization-cell';
                    cell.id = `viz-cell-${row}-${col}`;
                    cell.dataset.row = row;
                    cell.dataset.col = col;
                    // Use a sample symbol for visualization
                    const sampleSymbol = complexSymbolWeightedArray[Math.floor(Math.random() * complexSymbolWeightedArray.length)];
                    cell.textContent = sampleSymbol;
                    paylinesVisualizationGrid.appendChild(cell);
                }
            }
            
            // Create payline buttons
            paylinesButtonsContainer.innerHTML = '';
            PAYLINES.forEach((payline, index) => {
                const button = document.createElement('button');
                button.className = 'payline-button';
                button.textContent = `Payline ${index + 1}`;
                button.dataset.paylineIndex = index;
                button.addEventListener('click', () => highlightPayline(index));
                paylinesButtonsContainer.appendChild(button);
            });
        }
        
        // Highlight a specific payline
        function highlightPayline(paylineIndex) {
            // Remove all highlights
            document.querySelectorAll('.payline-visualization-cell').forEach(cell => {
                cell.classList.remove('highlighted');
            });
            
            // Remove active state from all buttons
            document.querySelectorAll('.payline-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Highlight the selected payline
            const payline = PAYLINES[paylineIndex];
            payline.forEach(([row, col]) => {
                const cell = document.getElementById(`viz-cell-${row}-${col}`);
                if (cell) {
                    cell.classList.add('highlighted');
                }
            });
            
            // Mark button as active
            const button = document.querySelector(`[data-payline-index="${paylineIndex}"]`);
            if (button) {
                button.classList.add('active');
            }
        }
        
        // Show paylines visualization modal
        showPaylinesButton.addEventListener('click', () => {
            initializePaylinesVisualization();
            paylinesVisualizationOverlay.classList.add('active');
        });

        complexHelpOverlay.addEventListener('click', (e) => {
            if (e.target === complexHelpOverlay) {
                complexHelpOverlay.classList.remove('active');
            }
        });

        // Initialize Complex Grid on page load
        initializeComplexGrid();
        
        // Load wallet balance on page load
        loadWalletBalance();
    </script>
</body>
</html>

